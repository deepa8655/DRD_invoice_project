{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>ğŸ‘¥ Manage Customers</h3>
    <a href="{{ url_for('new_invoice') }}" class="btn btn-secondary">â¬… Back to Invoices</a>
  </div>

  <!-- Add / Edit Form -->
  <form action="{{ url_for('add_customer') }}" method="POST" class="card p-3 mb-4">
    <input type="hidden" name="id" value="{{ customer.id if customer else '' }}">
    <div class="row g-2">
      <div class="col-md-4">
        <label class="form-label">Customer Name</label>
        <input type="text" class="form-control" name="name" value="{{ customer.name if customer else '' }}" required>
      </div>
      <div class="col-md-3">
        <label class="form-label">GST No</label>
        <input type="text" class="form-control" name="gst_no" value="{{ customer.gst_no if customer else '' }}">
      </div>
      <div class="col-md-3">
        <label class="form-label">PAN No</label>
        <input type="text" class="form-control" name="pan_no" value="{{ customer.pan_no if customer else '' }}">
      </div>
      <div class="col-md-2">
        <label class="form-label">State</label>
        <input type="text" class="form-control" name="state" value="{{ customer.state if customer else '' }}">
      </div>
        <div class="col-md-2">
        <label class="form-label">State Code</label>
        <input type="text" class="form-control" name="state_code" value="{{ customer.state_code if customer else '' }}">
      </div>
      <div class="col-8">
        <label class="form-label">Address</label>
        <textarea class="form-control" name="address">{{ customer.address if customer else '' }}</textarea>
      </div>
    </div>
    <button type="submit" class="btn btn-success mt-3">
      {{ 'Update Customer' if customer else 'Add Customer' }}
    </button>
  </form>

  <!-- Customer List -->
  <table class="table table-bordered table-striped align-middle">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>GST No</th>
        <th>PAN No</th>
        <th>State</th>
        <th>State Code</th>
        <th>Address</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for c in customers %}
      <tr>
        <td>{{ c.id }}</td>
        <td>{{ c.name }}</td>
        <td>{{ c.gst_no }}</td>
        <td>{{ c.pan_no }}</td>
        <td>{{ c.state }}</td>
        <td>{{ c.state_code }}</td>
        <td>{{ c.address }}</td>
        <td>
          <a href="{{ url_for('edit_customer', id=c.id) }}" class="btn btn-warning btn-sm">âœ Edit</a>
          <a href="{{ url_for('delete_customer', id=c.id) }}" class="btn btn-danger btn-sm"
             onclick="return confirm('Delete this customer?')">ğŸ—‘ Delete</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

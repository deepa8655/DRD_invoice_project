<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>DRD Invoice Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>

/* ---------- Pagination ---------- */
.pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 25px auto 10px;
  gap: 8px;
  width: 100%;
  text-align: center;
}


.page-link {
  padding: 8px 14px;
  border-radius: 6px;
  background: #f0f4ff;
  color: #007bff;
  font-weight: 600;
  text-decoration: none;
  transition: all 0.2s ease;
  border: 1px solid #007bff33;
}

.page-link:hover {
  background: #007bff;
  color: white;
}

.page-link.active {
  background: #007bff;
  color: #fff;
  pointer-events: none;
}

.page-link.disabled {
  opacity: 0.5;
  pointer-events: none;
}

    /* ---------- Base Styles ---------- */
    * { box-sizing: border-box; }
    body {
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #e3f2fd, #f8f9fa);
      color: #222;
      min-height: 100vh;
    }

    h1 {
      font-size: 28px;
      text-align: center;
      font-weight: 700;
      color: #004085;
      margin: 30px 0 20px 0;
    }

    .container {
      width: 90%;
      max-width: 1100px;
      margin: 0 auto 60px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      padding: 30px;
    }

    /* ---------- Header Buttons ---------- */
    .header {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      margin-bottom: 25px;
      gap: 10px;
    }

    .btn {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.25s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    }

    .btn:hover { transform: translateY(-2px); }

    .btn-primary {
      background: linear-gradient(135deg, #007bff, #0056b3);
      color: #fff;
    }

    .btn-secondary {
      background: linear-gradient(135deg, #28a745, #218838);
      color: #fff;
    }

    .btn-primary:hover { background: linear-gradient(135deg, #0069d9, #004a99); }
    .btn-secondary:hover { background: linear-gradient(135deg, #218838, #19692c); }

    /* ---------- Table Styling ---------- */
    table {
      width: 100%;
      border-collapse: collapse;
      border-radius: 12px;
      overflow: hidden;
      background: #fff;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    th, td {
      padding: 14px 16px;
      text-align: center;
      font-size: 14px;
      border-bottom: 1px solid #eee;
    }

    th {
      background-color: #007bff;
      color: #fff;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    tr:hover td {
      background-color: #f8f9ff;
      transition: background-color 0.2s ease;
    }

    /* ---------- Action Buttons ---------- */
    .actions {
      display: flex;
      justify-content: center;
      gap: 5px;
      flex-wrap: wrap;
    }

    .action-btn {
      border: none;
      cursor: pointer;
      border-radius: 6px;
      font-weight: 600;
      padding: 6px 10px;
      font-size: 12px;
      transition: all 0.25s ease;
    }

    .edit { background: #ffc107; color: #000; }
    .edit:hover { background: #e0a800; }
    .view { background: #17a2b8; color: #fff; }
    .view:hover { background: #138496; }
    .download { background: #28a745; color: #fff; }
    .download:hover { background: #1e7e34; }
    .delete { background: #dc3545; color: #fff; }
    .delete:hover { background: #c82333; }

    .no-data {
      text-align: center;
      padding: 30px;
      font-size: 16px;
      color: #888;
    }
/* ---------- Search & Filter ---------- */
.search-filter {
  margin-bottom: 25px;
  background: #f1f7ff;
  padding: 15px 20px;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}

.filter-form {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
  justify-content: space-between;
}

.filter-form input[type="text"],
.filter-form input[type="date"] {
  flex: 1;
  min-width: 180px;
  padding: 8px 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 14px;
}

.filter-form button,
.filter-form a {
  padding: 8px 14px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 600;
}

    /* ---------- Responsive ---------- */
    @media (max-width: 768px) {
      .header { flex-direction: column; gap: 10px; }
      table, thead, tbody, th, td, tr { display: block; }
      thead tr { display: none; }
      tr {
        margin-bottom: 15px;
        background: #fff;
        border-radius: 10px;
        padding: 12px;
        box-shadow: 0 3px 8px rgba(0,0,0,0.05);
      }
      td {
        text-align: right;
        padding: 10px;
        position: relative;
        border: none;
      }
      td::before {
        content: attr(data-label);
        position: absolute;
        left: 15px;
        top: 10px;
        font-weight: bold;
        color: #333;
      }
    }
  </style>
</head>

<body>
  <h1>üßæ DRD Invoice Dashboard</h1>

  <div class="container">
    <div class="header">
      <a href="{{ url_for('new_invoice') }}" class="btn btn-primary">+ Add New Invoice</a>
      <a href="{{ url_for('manage_customers') }}" class="btn btn-secondary">üë• Manage Customers</a>
<!-- Search & Filter Section -->
<div class="search-filter">
  <form method="GET" action="{{ url_for('index') }}" class="filter-form">
    <input type="text" name="search" placeholder="üîç Search by invoice no. or customer" value="{{ request.args.get('search', '') }}">
    
    <input type="date" name="start_date" value="{{ request.args.get('start_date', '') }}">
    <input type="date" name="end_date" value="{{ request.args.get('end_date', '') }}">
    
    <button type="submit" class="btn btn-primary">Filter</button>
    <a href="{{ url_for('index') }}" class="btn btn-secondary">Reset</a>
  </form>
</div>

    </div>

    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Invoice No</th>
          <th>Customer</th>
          <th>Date</th>
          <th>Bill Amount (‚Çπ)</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% if invoice_data %}
          {% for data in invoice_data %}
            <tr>
              <td data-label="ID">{{ data.invoice.id }}</td>
              <td data-label="Invoice No">{{ data.invoice.invoice_no }}</td>
              <td data-label="Customer">{{ data.invoice.customer.name }}</td>
              <td data-label="Date">
                {{ data.invoice.invoice_date.strftime('%d-%m-%Y') if data.invoice.invoice_date }}
              </td>
              <td data-label="Bill Amount">{{ "%.2f"|format(data.totals.bill_amount) }}</td>
              <td data-label="Actions">
                <div class="actions">
                  <a href="{{ url_for('edit_invoice', id=data.invoice.id) }}" class="action-btn edit">‚úè Edit</a>
                  <a href="{{ url_for('generate_invoice_pdf', id=data.invoice.id) }}" target="_blank" class="action-btn view">üëÅ View</a>
                  <a href="{{ url_for('save_invoice_pdf', id=data.invoice.id) }}" class="action-btn download">‚¨á Save</a>
                  <form action="{{ url_for('delete_invoice', id=data.invoice.id) }}" method="POST" style="display:inline;">
                    <button type="submit" class="action-btn delete" onclick="return confirm('Are you sure you want to delete this invoice?')">
                      üóë Delete
                    </button>
                  </form>
                </div>
              </td>
            </tr>
          {% endfor %}
        {% else %}
          <tr><td colspan="6" class="no-data">No invoices found.</td></tr>
        {% endif %}
      </tbody>
    </table>

    </table>

    <!-- Pagination -->
    {% if pagination %}
    <div class="pagination">
      {% if pagination.has_prev %}
        <a href="{{ url_for('index', page=pagination.prev_num) }}" class="page-link">‚¨Ö Prev</a>
      {% else %}
        <span class="page-link disabled">‚¨Ö Prev</span>
      {% endif %}

      {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
          {% if page_num == pagination.page %}
            <span class="page-link active">{{ page_num }}</span>
          {% else %}
            <a href="{{ url_for('index', page=page_num) }}" class="page-link">{{ page_num }}</a>
          {% endif %}
        {% else %}
          <span class="page-link">...</span>
        {% endif %}
      {% endfor %}

      {% if pagination.has_next %}
        <a href="{{ url_for('index', page=pagination.next_num) }}" class="page-link">Next ‚û°</a>
      {% else %}
        <span class="page-link disabled">Next ‚û°</span>
      {% endif %}
    </div>
    {% endif %}

  </div>
</body>
</html>
